\documentclass{beamer}
\usepackage{graphicx,amsmath,amsfonts,amssymb,listings,tikz}
\usepackage{multimedia}
\usetheme{Montpellier}
\usecolortheme{beaver}
\beamerdefaultoverlayspecification{<+->}
\definecolor{mygray}{rgb}{0.92,0.92,0.92}

\begin{document}

\section{Introduction}
\title{A Multiresolution Scheme for More Efficient Computations on Adaptive Mesh Refinement Blocks}
\author{Brandon Gusto} %
\institute{Dept. of Scientific Computing \\ Florida State University}
\date{\today}
\frame{\titlepage}

\section{Introduction}

\begin{frame}{Introduction}
    Many engineering applications depend on numerically solving systems of conservation laws of the form
    \begin{equation*}
        \mathbf{U}_{t} + \mathbf{F}(\mathbf{U})_{x} = \mathbf{S}(\mathbf{U})
    \end{equation*}
    where $\mathbf{U} = (\rho,\rho u,E)$ is a vector of conserved quantities,
    $\mathbf{F}(\mathbf{U})$ is a flux vector, and $\mathbf{S}(\mathbf{U})$ is a
    vector of source terms. The discretized solution are represented as
    averages over each cell
    \begin{equation*}
        \mathbf{U}_{i} = \frac{1}{|V_{i}|} \int_{V_{i}} \mathbf{U} dV.
    \end{equation*}
    where the $i$ denotes spatial index.
\end{frame}

\begin{frame}{Discretization}
    The semi-discretized form of system of PDEs is
    \begin{equation*}
        \frac{\partial \mathbf{U}_{i}}{\partial t} = -\frac{1}{|V_{i}|} \left( \mathbf{F}_{i+\frac{1}{2}}
            - \mathbf{F}_{i-\frac{1}{2}} \right) + \mathbf{S}_{i}
    \end{equation*}
    where the source terms are also averaged over each cell
    \begin{equation*}
        \mathbf{S}_{i} = \frac{1}{|V_{i}|} \int_{V_{i}} \mathbf{S} dV.
    \end{equation*}

\end{frame}

\begin{frame}{Solution Approaches}
    These equations are typically solved on a cartesian grid with non-uniform sized cells:
    \begin{itemize}
        \item<2-> the refinement needs to follow localized features
        \item<3-> some type of estimator of the local error is needed
        \item<4-> grid is typically refined in big groups (blocks) for efficiency
        \item<5-> blocks introduce inherent ``overresolution" in some regions of the mesh
    \end{itemize}
\end{frame}

\section{Refinement}

\begin{frame}{Block-Structured AMR}
    \begin{figure}
        \center
        \includegraphics[scale=0.4]{amr1.png}
    \end{figure}
\end{frame}

\begin{frame}{Block-Structured AMR}
    \begin{figure}
        \center
        \includegraphics[scale=0.4]{amr2.png}
    \end{figure}
\end{frame}

\begin{frame}{Block-Structured AMR}
    \begin{figure}
        \center
        \includegraphics[scale=0.4]{amr3.png}
    \end{figure}
\end{frame}

\begin{frame}{Block-Structured AMR}
    \begin{figure}
        \center
        \includegraphics[scale=0.4]{amr4.png}
    \end{figure}
\end{frame}

\begin{frame}{Filling Factor}
    The filling factor is the number of cells in a block which were flagged, divided by the total.
    As one reduces the block sizes...
    \begin{itemize}
        \item blocks with multiple parents becomes complicated
        \item communication between neighboring blocks becomes costly
    \end{itemize}
    \begin{figure}
        \center
        \includegraphics[scale=0.18]{filling.png}
    \end{figure}
\end{frame}

\section{Multiresolution}

\begin{frame}{a la Harten}
    \begin{itemize}
        \item<2-> Besides the AMR concepts, a multiresolution approach was also introduced by
            Harten. Grid is \textit{not} refined in space. Instead, a wavelet
            transform is performed on the uniform grid, and the fluxes are
            interpolated in smooth regions. \\
        \item<3->``The goal of a multi-scale decomposition of a discrete set of
            data is a "rearrangement" of its information content in such a way
            that the new discrete representation, exactly equivalent to the old
            one, is more "manageable" in some respects." - Arandiga, Donat
    \end{itemize}
\end{frame}

\begin{frame}{Multiresolution}
    Define multiple, nested grids
    \begin{equation*}
        \mathbf{G}^{l} = \left\{ x^{l}_{i+\frac{1}{2}} \right\}_{i=0}^{N_{l}} =
            \left\{ x^{l+1}_{i+\frac{1}{2}} \right\}_{i=0,\text{i even}}^{N_{l+1}}.
    \end{equation*}
    Coarsening of avarage data in cell done via
    \begin{equation*}
        \mathbf{U}^{l}_{i} = \frac{1}{2} \left( \mathbf{U}^{l+1}_{2i} + \mathbf{U}^{l+1}_{2i+1} \right)
    \end{equation*}
\end{frame}

\begin{frame}{Decomposition}
    The prediction from coarse to fine is done by
    \begin{equation*}
        \mathbf{\hat{U}}^{l+1}_{2i+1} = \sum_{j=1-s}^{s-1} \gamma_{j} \mathbf{U}^{l}_{i+j}
    \end{equation*}
    The regularity information is assessed by computing detail coefficients as
    \begin{equation*}
        \mathbf{d}^{l}_{i} = \mathbf{U}^{l+1}_{2i+1} - \mathbf{\hat{U}}^{l+1}_{2i+1}.
    \end{equation*}
    A mask $\left\{ \mathbf{m} \right\}_{i}^{N^{l}}$ is created for significant cells.
\end{frame}

\begin{frame}{Decomposition}
    \begin{figure}
        \center
        \input{predict_coarsen.tex}
    \end{figure}
\end{frame}

\begin{frame}{Multiresolution Representation}
    \begin{figure}
        \center
        \includegraphics[scale=0.4]{eps0.png}
    \end{figure}
\end{frame}

\begin{frame}{Multiresolution Representation}
    \begin{figure}
        \center
        \includegraphics[scale=0.4]{eps1e6.png}
    \end{figure}
\end{frame}

\begin{frame}{Multiresolution Representation}
    \begin{figure}
        \center
        \includegraphics[scale=0.4]{eps1e3.png}
    \end{figure}
\end{frame}

\begin{frame}{Multiresolution Representation}
    \begin{figure}
        \center
        \includegraphics[scale=0.4]{eps1e1.png}
    \end{figure}
\end{frame}

\begin{frame}{Fluxes}
    Once the forward wavelet transform has been computed on cell-averaged solution data...
    \begin{itemize}
        \item<2-> utilize this regularity information to identify sufficiently smooth regions
            in which to interpolate the flux.
        \item<3-> introduce sufficiently large buffer region (why?) around flagged cells
        \item<4-> perform inverse transform and compute or interpolate fluxes
    \end{itemize}
\end{frame}

\begin{frame}{Convergence}
  Sine wave advection after one period:
  \begin{figure}
    \center
    \includegraphics[scale=0.5]{convergence.png}
  \end{figure}
\end{frame}

\begin{frame}{Outlook}
  \begin{itemize}
    \item develop performance study for effect of filling factor on time to
          solution, overheads... with and without wavelet scheme
    \item weakly compressible turbulence (uniform mesh)
    \item compressible turbulence (potentially adaptive)
    \item turbulent combustion (adaptive)
  \end{itemize}
\end{frame}
  
\begin{frame}{Turbulence}
  \begin{figure}
    \center
    \includegraphics[scale=0.15]{tburn1.png}
  \end{figure}
\end{frame}

\end{document}
